# Trident Audit Log — 2026-02-16

9 parallel audits, 210 files, 12 passes each. Findings only (PASS entries stripped).
Severity: C=critical, M=major, m=minor. Pass in parentheses.

## Root / Config / Diagnostic

001 M  F-DIAG-1      diagnostic/mod.rs:83         .unwrap() on eprint — panics on broken stderr (P5)
002 M  F-TARGET-1a   config/target/mod.rs:247      .unwrap() on strip_prefix (P5)
003 M  F-TARGET-1b   config/target/mod.rs:258      .unwrap() on last_mut (P5)
004 M  F-RESOLVE-1   config/resolve/mod.rs:1       HashSet — use BTreeSet (P1)
005 M  F-RESOLVE-2   config/resolve/mod.rs:83      find_lib_dir unbounded ancestor walk (P2)
006 M  F-SCAFFOLD-1  config/scaffold/mod.rs:265    HashSet in extract_variables (P1)
007 M  F-PROJ-1      config/project.rs             No project name validation (P7)
008 m  F-PROJ-2      config/project.rs             Missing error path tests (P12)
009 m  F-RESOLVER-2  config/resolve/resolver.rs    No depth/count limit on discover_all (P2)
010 m  F-RESOLVER-3  config/resolve/resolver.rs    find_vm_dir duplicates find_lib_dir (P10)
011 m  F-RESOLVER-4  config/resolve/resolver.rs    Missing tests for vm path, deps, circular (P12)
012 m  F-OS-1        config/target/os.rs           parse_string_array misplaced (P8)
013 m  F-RESTESTS-1  config/resolve/tests.rs       Missing resolution path tests (P12)

## Syntax (Lexer / Parser / Format / Grammar)

014 M  L5-1          syntax/lexer/mod.rs           Six .unwrap() on from_utf8 (P5)
015 M  E2-1          syntax/parser/expr.rs         parse_expr_bp unbounded recursion (P2)
016 m  E5-1          syntax/parser/expr.rs:148,168 .unwrap() on path ops (P5)
017 m  F11-1         syntax/format/mod.rs          O(comments*nodes) scan (P11)
018 m  T7-1          syntax/parser/types.rs        parse_array_size_expr unbounded recursion (P7)
019 m  SIZE          syntax/grammar/trident.rs     594 lines — exceeds 500 limit (P10)

## AST / TypeCheck

020 C  C01           ast/mod.rs:157                ArraySize::eval unchecked u64 add — silent overflow (P3)
021 C  C02           ast/mod.rs:147                ArraySize::as_literal unchecked u64 add/mul (P3)
022 M  M03           ast/navigate.rs:45            .unwrap() in library code (P5)
023 M  M04           typecheck/mod.rs+analysis     HashSet where BTreeSet required (P1)
024 M  M06           typecheck/expr.rs:160         mono_instances O(n) linear scan (P11)
025 M  M07           typecheck/types.rs:54         *n as u32 truncates u64 silently (P3)
026 M  M08           typecheck/types.rs:25,49      width() u32 sum overflow (P3)
027 M  M10           typecheck/stmt.rs:325         Struct match unconditionally exhaustive (P7)
028 M  M11           typecheck/block.rs:52         .unwrap() in library code (P5)
029 M  M12           typecheck/resolve.rs:99       Unknown Type::Named silently -> Ty::Field (P6)
030 M  M13           typecheck/analysis.rs:72      Recursive DFS cycle detection — stack overflow (P7)
031 m  M01           ast/mod.rs:156                ArraySize::eval returns 0 for unknown params (P6)
032 m  M02           ast/mod.rs                    No depth limit on ArraySize recursion (P7)
033 m  N02           typecheck/types.rs:20         StructTy.fields uses tuple not named struct (P9)
034 m  N04           typecheck/expr.rs             Sentinel Ty::Field cascading false errors (P5)
035 m  N05           typecheck/builtins.rs         is_io_builtin prefix matching fragile (P5)
036 m  N06           typecheck/analysis.rs         Duplicated AST walking in collect_calls/used (P10)

## IR (KIR / TIR / LIR / Tree)

037 C  IR-LIR-1      ir/lir/mod.rs:30,42           Reg and Label derive Hash — enables HashMap (P1)
038 M  IR-BUILD-1    ir/tir/builder/mod.rs:72      cfg_flags: HashSet (P1)
039 M  IR-STACK-1    ir/tir/stack.rs               access_var returns 0 for both depth-0 and not-found (P6)
040 M  IR-EXPR-1     ir/tir/builder/expr.rs        Silent Comment("ERROR:...") + Push(0) (P6)
041 M  IR-LINK-1     ir/tir/linker.rs              Empty entry_label when no program module (P6)
042 M  IR-LINK-2     ir/tir/linker.rs              Fuzzy suffix-based label resolution (P7)
043 M  IR-LIR-2      ir/lir/convert.rs             todo!() and .expect() panics (P6)
044 M  IR-TRITON-1   ir/tir/lower/triton.rs        Shl/Shr semantics ambiguity (P3)
045 M  IR-BUILD-2    ir/tir/builder/mod.rs          emit_multi_ret_cleanup Swap(k) k>15 (P7)
046 M  IR-CALL-1     ir/tir/builder/call.rs        Dual dispatch build_call/emit_call_only DRY (P8)
047 M  IR-STMT-1     ir/tir/builder/stmt.rs:207,271 unwrap_or(0) silent tag 0 collision (P6)
048 M  IR-OPT-1      ir/tir/optimize.rs            Spill elimination matches inline asm (P7)
049 m  IR-EXPR-2     ir/tir/builder/expr.rs:148    .unwrap() in fallback (P5)
050 m  IR-EXPR-3     ir/tir/builder/expr.rs:174    Unreachable var emits trap, no diagnostic (P6)
051 m  IR-LAYOUT-1   ir/tir/builder/layout.rs      resolve_type_width returns 1 for Named (P5)
052 m  IR-LOWER-1    ir/tir/lower/mod.rs           _target ignored — always Triton (P8)
053 m  SIZE-a        ir/tir/stack.rs               506 lines (P10)
054 m  SIZE-b        ir/tir/optimize.rs            633 lines (P10)
055 m  SIZE-c        ir/tir/builder/mod.rs         529 lines (P10)
056 m  SIZE-d        ir/tir/builder/stmt.rs        502 lines (P10)
057 m  SIZE-e        ir/tir/builder/tests.rs       654 lines (P10)

## Cost / Verify

058 C  D1-SMT        verify/smt/mod.rs:17          HashSet for declared_vars — non-deterministic SMT (P1)
059 C  F1-SYM        verify/sym/mod.rs:117         wrapping_sub — wrong field subtraction (P3)
060 C  F2-SYM        verify/sym/mod.rs:93          wrapping_add — wrong field addition (P3)
061 M  D2-COST       cost/analyzer.rs:31           f64 for estimated_proving_secs (P1)
062 M  D3-COST       cost/report.rs:104,137        f64 for ratio/percentage (P1)
063 M  T1-COST       cost/analyzer.rs:103          .unwrap() (P5)
064 M  T1-SYNTH      verify/synthesize/infer.rs:179 .unwrap() (P5)
065 M  T1-SMT        verify/smt/runner.rs:32       .unwrap() on temp path (P5)
066 M  A2-SYM        verify/sym/executor.rs:~155   Unbounded loop unrolling (P7)
067 M  A3-SYM        verify/sym/mod.rs             Unbounded constraint system (P7)
068 M  K1-CEGIS      verify/synthesize/infer.rs:186 build_verification_source always None — dead CEGIS (P10)
069 M  E1-EVAL       verify/solve/eval.rs:47       assert! panic in field_inv (P6)
070 M  E2-MODEL      cost/model/mod.rs:235         eprintln! in library code (P6)
071 M  P1-SOLVE      verify/solve/mod.rs           O(n^2) variable collection (P11)
072 m  D4-SYNTH      verify/synthesize/mod.rs:38   f64 for confidence (P1)
073 m  B1-COST       cost/analyzer.rs:154          Recursion guard caching gap (P2)
074 m  C1-EVAL       verify/solve/eval.rs:123      No domain separation in pseudo-hash (P4)
075 m  N2-SYM        verify/sym/executor.rs:~155   Magic number 64 for max unroll (P9)
076 m  N4-REPORT     cost/report.rs                H0003 hint code missing (P9)
077 m  K4-SOLVER     verify/solve/solver.rs        Constraint check loop duplicated 4x (P10)
078 m  K5-VERIFY     verify/solve/mod.rs           Union-then-intersect convoluted (P10)
079 m  X2-SYM        verify/sym/tests.rs           Missing edge-case tests (P12)

## CLI / Deploy / API

080 C  D1-BENCH      cli/bench.rs:86,101           f64 arithmetic in bench (P1)
081 C  D2-API        api/tools.rs:129,139          f64 fields in public API (P1)
082 M  T1-VERIFY     cli/verify.rs:74              .unwrap() (P5)
083 M  T2-CLI        cli/mod.rs:96                 .unwrap() (P5)
084 M  E1-CLI        cli/mod.rs:164                prepare_artifact swallows compilation errors (P6)
085 M  E2-CLI        cli/mod.rs:170                Silent fallback to zero-cost ProgramCost (P6)
086 M  K1-DUP        cli/bench.rs+api/tools.rs     fmt_num/fmt_ratio/status_icon duplicated (P10)
087 M  E4-REG        cli/registry.rs:77            cb.save() failure doesn't exit (P6)
088 M  B1-CLI        cli/mod.rs:313                collect_tri_files_recursive unbounded depth (P2)
089 M  A5-INIT       cli/init.rs:47                No project name validation — TOML injection (P7)
090 M  A3-CLI        cli/mod.rs:312                No file count limit (P7)
091 M  X1-CLI        cli/ (all)                    Zero unit tests for cmd_* functions (P12)
092 m  D3-CLI        cli/mod.rs:181                f64 literal for estimated_proving_secs (P1)
093 m  D4-DEPLOY     deploy/mod.rs:330             SystemTime::now() non-reproducible (P1)
094 m  C1-DEPLOY     cli/deploy.rs:51              Fragile line-matching for dry-run (P4)
095 m  E6-BENCH      cli/bench.rs:60               No error count — always exits 0 (P6)
096 m  E7-FMT        cli/fmt.rs:31                 Format errors don't affect exit code (P6)
097 m  N1-DUP        api/tools.rs+cli/bench.rs     Duplicated formatting utilities (P9)
098 m  K3-API        api/mod.rs:192                run_tests duplicates compilation logic (P10)

## Package (Store / Registry / Hash / Poseidon2 / Cache)

099 C  P3-RED        poseidon2.rs:54               reduce128 may truncate high bits (P3)
100 C  P7-HTTP-1     registry/client.rs:188        No Content-Length cap — OOM (P7)
101 C  P7-HTTP-2     registry/client.rs:194        Chunked transfer no size limit (P7)
102 M  P1-DEPS       store/deps.rs:6               HashSet in deterministic pipeline (P1)
103 M  P4-DOMAIN     poseidon2.rs                  No domain separation in sponge (P4)
104 M  P7-TIMEOUT    registry/client.rs:153        No connect timeout (P7)
105 M  P7-JSON       registry/json.rs              No size limits on JSON (P7)
106 M  P11-CONST     poseidon2.rs:173              Constants regenerated every permutation (P11)
107 M  P5-HASH       hash/mod.rs:30                ContentHash inner field pub (P5)
108 M  P6-PRINT      registry/store_integration:28 eprintln! in library (P6)
109 M  P6-SAVE       store/mod.rs:260              Non-atomic Codebase::save (P6)
110 M  P10-DEAD      hash/normalize.rs:137         Dead code in hash_file (P10)
111 M  P11-CLONE     hash/normalize.rs:139,148     fn_hashes.clone() per fn — O(n^2) (P11)
112 m  P4-CERT       registry/types.rs:31          Unvalidated verification certs (P4)
113 m  P7-STR        hash/normalize.rs:178         write_str truncates at u16::MAX (P7)
114 m  P7-SPLIT      registry/json.rs:217          split("},{") fragile (P7)
115 m  P9-BASE32     hash/mod.rs:62                Crockford base32 alphabet unnamed (P9)
116 m  P10-TAGS      hash/normalize.rs:14          Unused serialization tags (P10)

## LSP

117 M  H1-MUTEX      lsp/mod.rs (17 sites)         .lock().unwrap() — poisoned mutex crash (P5)
118 M  H2-CACHE      lsp/project.rs+intelligence   No caching — re-parses on every hover (P11)
119 M  H3-OFFSET     lsp/util/mod.rs               byte_offset_to_position O(N) per call (P11)
120 M  M1-BUILTIN    lsp/builtins.rs               38 builtins repeated 3x (P10)
121 M  M2-MUT        lsp/actions.rs:81             add_mut_keyword finds first occurrence (P7)
122 M  M3-ASU32      lsp/actions.rs:109            remove_redundant_as_u32 parses from diagnostic (P7)
123 m  M5-SHIFT      lsp/incremental.rs:149        debug_assert no release protection (P7)
124 m  M6-FOLD       lsp/folding.rs                No unit tests (P12)
125 m  M6-SEL        lsp/selection.rs              No unit tests (P12)
126 m  L2-SEL        lsp/selection.rs:8            No position count limit (P7)
127 m  L7-LOCK       lsp/references.rs:109         do_document_highlight double mutex lock (P11)

## Trident Sources (.tri)

128 C  TRI-MULMOD    std/crypto/bigint.tri         mul_mod truncates to 256 bits before reduction (P3)
129 C  TRI-ED-STUB   std/crypto/ed25519.tri        point_add/scalar_mul stubs — verify accepts all (P5)
130 C  TRI-SECP      std/crypto/secp256k1.tri      Depends on broken bigint.mul_mod (P3)
131 C  TRI-POS-PH    std/crypto/poseidon.tri       Placeholder — wrong S-box, MDS, constants (P3)
132 C  TRI-NTT       std/private/poly.tri          NTT: 3 bugs — bounds, twiddle, cyclic (P3)
133 M  TRI-SUB256    std/crypto/bigint.tri         sub256 silently wraps on underflow (P7)
134 M  TRI-LOWS      std/crypto/ecdsa.tri          is_low_s doesn't enforce BIP-62 (P7)
135 M  TRI-RELU      std/nn/tensor.tri             relu compares only high 32 bits (P3)
136 M  TRI-AUTH1     os/neptune/locks/multisig.tri verify_key compares only h0 — 64-bit collision (P7)
137 M  TRI-AUTH2     os/neptune/standards/plumb.tri verify_auth compares only h0 (P7)
138 M  TRI-OPCODE1   os/neptune/standards/card.tri silent success for invalid opcodes (P7)
139 M  TRI-OPCODE2   os/neptune/standards/coin.tri silent success for invalid opcodes (P7)
140 M  TRI-MINT      os/neptune/types/custom_token mint disabled relies on hash != 0 (P7)
141 M  TRI-PROOF     os/neptune/proof.tri          verify_inner_proof accepts prover ptrs (P7)
142 M  TRI-ED-ACC    std/crypto/ed25519.tri        verify accepts sigs when stubs return identity (P5)
143 m  TRI-INV       vm/core/field.tri             inv lacks a==0 docs (P3)
144 m  TRI-LOG2      vm/core/u32.tri               log2 undocumented for 0; pow overflow (P3)
145 m  TRI-SHL       std/crypto/bigint.tri         shl_one_limb dead code (P10)
146 m  TRI-POW2      std/crypto/keccak256.tri      u32_pow2 returns 2^31 for n>=32 (P9)
147 m  TRI-SHA-NAME  std/crypto/sha256.tri         pow2_25c/pow2_25 confusing naming (P10)
148 m  TRI-NTT-CMT   std/private/poly.tri          Stale comment on result variable (P9)
149 m  TRI-BOILER    os/neptune/standards/card.tri Config verification duplicated 5x (P10)
150 m  TRI-DEAD      os/neptune/standards/coin.tri hash_metadata dead code (P10)
151 m  TRI-MEAS      std/quantum/gates.tri         measure_deterministic approximate near p/2 (P3)
